# 农业管理系统数据初始化指南

## 📋 概述

`initialize-system-data.sh` 脚本用于一键初始化农业管理系统的所有基础数据。该脚本会按照数据依赖关系依次创建各类数据，确保数据的完整性和关联性。

## 🚀 使用方法

### 前置条件
1. Spring Boot 应用已启动并运行
2. DataInitializer 已创建初始管理员用户 (admin/admin123)
3. 数据库连接正常，所有表结构已创建

### 执行步骤
```bash
# 1. 确保应用正在运行
cd backend
mvn spring-boot:run

# 2. 在另一个终端执行初始化脚本
cd backend
./initialize-system-data.sh
```

## 📊 初始化数据详情

### 1. 用户数据 (Users)
| 用户名 | 角色 | 姓名 | 邮箱 |
|--------|------|------|------|
| admin | ADMIN | 管理员 | admin@example.com |
| farmer_zhang | FARMER | 张三 | zhangsan@farm.com |
| staff_li | STAFF | 李四 | lisi@farm.com |

### 2. 农田数据 (Farmlands)
| 农田名称 | 面积(㎡) | 状态 | 位置 | 描述 |
|----------|----------|------|------|------|
| 蔬菜种植区A | 5000 | AVAILABLE | 东区蔬菜基地 | 蔬菜种植现代化农田 |
| 粮食种植区B | 10000 | AVAILABLE | 西区粮食基地 | 大型粮食作物种植区 |
| 试验田C | 2000 | AVAILABLE | 南区试验基地 | 农业科研试验田 |

### 3. 作物数据 (Crops)
| 作物名称 | 品种 | 季节 | 生长期(天) | 预期产量 | 特点 |
|----------|------|------|-------------|----------|------|
| 番茄 | 樱桃番茄 | 春季 | 90 | 8000kg/亩 | 小巧甜美，鲜食加工 |
| 黄瓜 | 温室黄瓜 | 春季 | 75 | 6000kg/亩 | 品质优良，全年种植 |
| 水稻 | 杂交水稻 | 春季 | 120 | 800kg/亩 | 高产稳产，优质品种 |
| 小麦 | 强筋小麦 | 秋季 | 240 | 600kg/亩 | 面粉专用，优质品种 |
| 玉米 | 甜玉米 | 春季 | 100 | 1200kg/亩 | 口感鲜美，产量高 |

### 4. 种植计划数据 (Planting Plans)
| 计划名称 | 农田 | 作物 | 开始日期 | 结束日期 | 状态 |
|----------|------|------|----------|----------|------|
| 2024年春季樱桃番茄种植计划 | 蔬菜种植区A | 番茄 | 2024-04-01 | 2024-06-30 | COMPLETED |
| 2024年春季杂交水稻种植计划 | 粮食种植区B | 水稻 | 2024-04-15 | 2024-08-15 | COMPLETED |

### 5. 种植记录数据 (Planting Records)
| 种植计划 | 操作类型 | 操作日期 | 用量 | 天气 | 备注 |
|----------|----------|----------|------|------|------|
| 番茄种植计划 | SOWING | 2024-04-05 | 2000kg | 晴天18°C | 营养钵育苗，发芽率95% |
| 番茄种植计划 | FERTILIZING | 2024-04-10 | 150kg | 多云22°C | 施用有机复合肥 |
| 水稻种植计划 | SOWING | 2024-04-20 | 500kg | 晴天25°C | 抛秧机机插秧 |

### 6. 生长监测数据 (Growth Monitoring)
| 种植计划 | 监测日期 | 高度(cm) | 宽度(cm) | 健康状态 | 温度(°C) | 土壤湿度(%) |
|----------|----------|----------|----------|----------|-----------|-------------|
| 番茄种植计划 | 2024-04-15 | 15.5 | 8.2 | EXCELLENT | 24.5 | 68.5 |
| 水稻种植计划 | 2024-04-25 | 12.8 | 6.5 | GOOD | 26.8 | 72.3 |

### 7. 通知提醒数据 (Notifications)
| 标题 | 类型 | 优先级 | 计划发送时间 | 状态 | 接收者 |
|------|------|--------|--------------|------|--------|
| 樱桃番茄施肥提醒 | FERTILIZING | MEDIUM | 2026-04-25 09:00 | PENDING | 全部用户 |
| 水稻灌溉提醒 | WATERING | HIGH | 2026-04-26 08:00 | PENDING | 管理员+农民 |
| 作物生长监测提醒 | MONITORING | LOW | 2026-04-30 10:00 | PENDING | 管理员+工作人员 |

### 8. 数据分析报告 (Reports)
| 报告标题 | 类型 | 时间范围 | 特点 |
|----------|------|----------|------|
| 2024年第一季度作物生长分析报告 | CROP_GROWTH | 2024-01-01至2024-03-31 | 包含生长趋势图表 |
| 2024年农田利用率分析报告 | FIELD_UTILIZATION | 2024-01-01至2024-03-31 | 利用率统计分析 |
| 2024年第一季度天气影响分析报告 | WEATHER_IMPACT | 2024-01-01至2024-03-31 | 气象数据分析 |

## 🔧 技术特性

### 数据关联性
- 所有数据按照外键关系正确关联
- 种植计划关联农田和作物
- 种植记录关联种植计划
- 生长监测关联种植计划
- 通知提醒可关联种植计划
- 报告由用户生成

### 数据完整性
- 日期范围验证（开始日期 ≤ 结束日期）
- 数值范围验证（符合实际农业参数）
- 用户权限验证（生成者必须存在）
- 关联数据存在性验证

### 可扩展性
- 数据量可根据需要调整
- JSON字段支持复杂图表数据
- 枚举类型支持业务扩展
- 备注字段支持详细信息

## 🎯 测试验证

初始化完成后，可以运行以下测试脚本验证功能：

```bash
# 用户管理测试
./test-user-api.sh

# 农田管理测试
./test-farmland-api.sh

# 作物管理测试
./test-crop-api.sh

# 种植计划测试
./test-planting-plan-api.sh

# 种植记录测试
./test-planting-record-api.sh

# 生长监测测试
./test-growth-monitoring-api.sh

# 通知管理测试
./test-notification-api.sh

# 报告管理测试
./test-report-api.sh
```

## 📝 注意事项

1. **重复执行**: 脚本会智能跳过已存在的数据，不会重复创建
2. **数据清理**: 如需重新初始化，可先清理数据库或修改测试数据
3. **生产环境**: 初始化数据仅用于测试，生产环境请使用实际业务数据
4. **日期调整**: 示例中的日期可根据实际需要调整（种植计划为未来日期，报告为历史日期）
5. **密码安全**: 测试用户密码都是明文，生产环境请使用加密存储

## 🚀 快速开始

```bash
# 1. 启动应用
cd backend
mvn spring-boot:run

# 2. 初始化数据
./initialize-system-data.sh

# 3. 验证数据
curl -X GET "http://localhost:8080/api/users" \
  -H "Authorization: Bearer YOUR_TOKEN"

# 4. 开始测试API
./test-user-api.sh
```

## 📞 技术支持

如有问题，请检查：
1. Spring Boot 应用是否正常运行
2. 数据库连接是否正常
3. JWT token 是否有效
4. 网络连接是否畅通

---

*该初始化脚本为农业管理系统提供了完整的测试数据，帮助开发者快速验证系统功能和进行前端开发。*
